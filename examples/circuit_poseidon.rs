use ff::{Field, PrimeField};
use halo2curves::bn256::Fr;
use lazy_static::lazy_static;
use nova_snark::{
  frontend::{num::AllocatedNum, ConstraintSystem, SynthesisError},
  nova::{PublicParams, RecursiveSNARK},
  provider::{Bn256EngineKZG, GrumpkinEngine},
  traits::{circuit::StepCircuit, snark::RelaxedR1CSSNARKTrait},
};

type E1 = Bn256EngineKZG;
type E2 = GrumpkinEngine;
type EE1 = nova_snark::provider::hyperkzg::EvaluationEngine<E1>;
type EE2 = nova_snark::provider::ipa_pc::EvaluationEngine<E2>;
type S1 = nova_snark::spartan::snark::RelaxedR1CSSNARK<E1, EE1>;
type S2 = nova_snark::spartan::snark::RelaxedR1CSSNARK<E2, EE2>;

pub struct PoseidonConstants {
  pub c: Vec<Fr>,
  pub m: Vec<Vec<Fr>>,
  pub p: Vec<Vec<Fr>>,
  pub s: Vec<Fr>,
}

impl PoseidonConstants {
  pub fn new() -> Self {
    Self {
      c: vec![
        Fr::from_str_vartime(
          "6745197990210204598374042828761989596302876299545964402857411729872131034734",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "426281677759936592021316809065178817848084678679510574715894138690250139748",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4014188762916583598888942667424965430287497824629657219807941460227372577781",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3755116341545840759015036961635468144365099804379460727348866960676715430295",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20392683181271908962657137166167696619865229065446607574667232999928814731550",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6703994282500560979989445930081874901355102371090652156329919603050069367661",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17189230569231604821073310501737896533088589624978650476197226450738944009738",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18531998296162357308313149608963848512728570123579345240911571045895174353605",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4433884058681415052165697534405705901078937172224017064607454469338590163489",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8020484089444009184801117822789130075555480739986478064377452360454228170229",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20560640391555251236826668015235029471365697963893708697460632109250285318704",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17735423966452908760211059923359580380884879536808777323265778948947638259763",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6791331612302297428695549285132291741490338679013661880702099967749867646461",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10419627351290227145210525084258167372914788967175798542355001482631316994244",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6206851612052541638976352943215840028030801164970177880767418169520708772536",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "16375603635162350436232250364669249324451378530661474785953680978023373794530",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15688345709279674878722778274755546879655509895442959219801847456408443245585",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9491195295080912096808640399994744159859678118343162847585525711429214413024",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9797453712978351739894993124526343599910864939600507506817907398049628087845",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21481156634888978845506145026281060650315619389631972720682147891193932034748",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1544695019100535789562080715491958130358622823716581449438533301216924752935",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15153967549418678242792255556974876142451438236452833905885476522771426565724",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4591255420184723367998678386069903388982581566230137478170120814157251999972",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13993317492298544887941044850630591562583461951060762639175439957405637125554",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18050986222741620548156772647408352996300510941831685700744011415483819773010",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "582246807524529302909723370549441534244069879807711548626660000973375204921",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17980568461424306839096120761698253698461014969574413132599910426852670637994",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14228661217337404173590037181281556515313880823067200751208433351015082633231",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17176587110943721909591525594639263627408109053511250375171964599662347949654",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7286056960291791961279922035116305681626907328744157355775762073644197019846",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11801365285243706250823971466535819473941637258351304973449723129085888576630",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6789889064944432682687629097717611651009674254338563170567306510098910540667",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9550619200100511068539661405398488623937521959417695171688138140248257936329",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "16927894918204554097233146055322393983512297393314402761978026471334045088468",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2296319279680349420807150717514761554038762184731526596983718190376193064033",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13381111760207441008426119944140900703001726391920993676751870388659584018005",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11282457978268307664923525713815776526107144144595041430117539563509678852564",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17377518636062549822834113219764678554103258757534291706153558084302477704360",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20529239671116714650308624442796341176059426819897849304552671207130860806391",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "19313513922305909359661088066839481510878680142785006144992893032981513750163",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12181397983537742191390434344829585062040306747989867043080195299198026532297",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11112906716400273414317383189828104351449782172976766156576450389221891985945",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "16412541736785056759381201344213663399564662372426071178293124552177642678859",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "659264346779336196861046149708262978772865549957418762539334998250261177999",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4845513029979932068519665574875148103907087162327411884857282514189560116135",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5002732758219210120345003630968063328669992882526477928389701063084122341769",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10252016712022906174591128558929263661248150132143972390462416316600730571625",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21429601688543276478479631702989513062244319445797869558505239085486171344224",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11227063021005188138910539120180069062417117307677326631195927999578666832402",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2254910728581601099491456127797625022511731921877856968562861178616799012230",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5924174077205168234689774914167707651618793087685768535543746729243682127746",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "329090408153092313434075726893539446277285458579468693042578376323593473572",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3484834587887234802733103827332793869706642074000786703905145704379481896136",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12759747455419586364957557614124565024455324273775792120780800828643067189145",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13150191605185674559081945246113753211459390086746711042772368219406961549392",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6143756015450030363279441218617635078858673495963778498235578799829663351430",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18969449300908196125647274430671901552593706566744295860846386166630317453793",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1852637158976378935795799109534699742700007284464701345503208109137291661250",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9326761420703801200266867558954051317841905707190944714132337564904087549583",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6279482686602249364815416065639446422429357296367124306817890060402815786728",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8520294966848398129322322020893248716223461240734329732456748763332989445897",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15681345134148763222663156294793340025833734930392220652982726544070262099820",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17329667728585195296928718012738338154006158317991934918090698864750378948204",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13283998627857168043664255754669222819501427102611857382896531955237893912656",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6734950835262505445568244961310758511728644659360842525493721393514729768139",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12640921348554222969118773328433453835370715908163239963534972271298897423616",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3473754313923508472440372769623619753166905053830046385167341619128450077793",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15149348017909893881037206267370389784518482186719845804410708430161111942280",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15095929898353593452741657787428497312742822726453112001822847009791172948206",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13779749201323782722498931190091600155866019828880573899249510809182581025824",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21432322857364472753097486153424499274800937939449547067783750545210710387999",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "16479367804307361551951437245808989924478832646635984335550324334063271392915",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "148255380784797435050988367748108707226071678329729231552544164474530475505",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12455016963320286149943199170327213031856517334199847717911791239594264576635",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4938484771207094241571416021225789188526145811651959458066207028490239487168",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10246318579378663345685131761175422014521877772325576451685137097369004581518",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2049050629479134839952087472704012659976710958814656030641046436125418443803",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13777389069170762688650820825296135648364766834707603999268593030539102422931",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2293465760578772130353203454994751988060752014172004238858851708494457550991",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6173354726105518526365269037588149920975300908099965898051063758804317864818",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20864884888700633737572601890135683935475037549132028663329735513632822631102",
        )
        .unwrap(),
      ],
      m: vec![
        vec![
          Fr::from_str_vartime(
            "7511745149465107256748700652201246547602992235352608707588321460060273774987",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "18732019378264290557468133440468564866454307626475683536618613112504878618481",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "9131299761947733513298312097611845208338517739621853568979632113419485819303",
          )
          .unwrap(),
        ],
        vec![
          Fr::from_str_vartime(
            "10370080108974718697676803824769673834027675643658433702224577712625900127200",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "20870176810702568768751421378473869562658540583882454726129544628203806653987",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "10595341252162738537912664445405114076324478519622938027420701542910180337937",
          )
          .unwrap(),
        ],
        vec![
          Fr::from_str_vartime(
            "19705173408229649878903981084052839426532978878058043055305024233888854471533",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "7266061498423634438633389053804536045105766754026813321943009179476902321146",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "11597556804922396090267472882856054602429588299176362916247939723151043581408",
          )
          .unwrap(),
        ],
      ],
      p: vec![
        vec![
          Fr::from_str_vartime(
            "7511745149465107256748700652201246547602992235352608707588321460060273774987",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "13765730681189380936346492971955185320534160954304757809496083602133165929757",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "12595446607664744934103076352963528000966896978346099459720409268422440395879",
          )
          .unwrap(),
        ],
        vec![
          Fr::from_str_vartime(
            "10370080108974718697676803824769673834027675643658433702224577712625900127200",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "20498480049173041451757161739353136932402063966867101132544382489060457121690",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "12226297560593729389190789373669758216633073552812492133170543943243249907657",
          )
          .unwrap(),
        ],
        vec![
          Fr::from_str_vartime(
            "19705173408229649878903981084052839426532978878058043055305024233888854471533",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "8087150636429993556473620686397944819119746067671291185379890893406156055968",
          )
          .unwrap(),
          Fr::from_str_vartime(
            "15428267695360211473228142908425586842453705255249103144570280918777118090173",
          )
          .unwrap(),
        ],
      ],
      s: vec![
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1781874611967874592137274483616240894881315449294815307306613366069350853425",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9676220459425127104563807626505378474104527268335041816433595157913150665495",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8364259238812534287689210722577399963878179320345509803468849104367466297989",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2889496767351495797946386949910896668575115361724249874917471657626490587069",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15203863717131037243487133177680233750660694097162830026522190480319019526887",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1645017323598148583308153743253948043010266295265950623794066679542803673813",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14985926134451618201070782922146535777997354606230522118685156055564432923596",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11497455747123870842609033487886196057746577750687517341166074505317007288078",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18109765756899962487111075951493451762273621105151506450773344342109668201999",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8034324828084400593020431506480243533881627849088152439427470035355284392177",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "16846229027008741913165717881259554980809057413299912150488284683744940628261",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21835563963581578576271778192505404662763222948742168673583931448375408835935",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21536618802882283440947141155118738832596020335348742727957480541943406874436",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13397320511797493654805969878195367010267669507871486661614614086160548021432",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8274817596976627060721446579061034932059250181790318658419016654356916553793",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11559576119047297261718762577915230877068346446232753309523408281532457130418",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21110548928163625108646189707151361569577559205105116148655680158775559847460",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13965463506707211992011711863952040570118432896827711820318513847839923700006",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2754464625251737051452042869297896380028509218065510607416300542624867449301",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10907469474459001232698351613440362499830316226097001251678076978108377020171",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20501774224204372540136096556482919283387738959798723353983096093423267639300",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9836931077600326261954341466265192955109945505714894685102395567763076425240",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "19217533572284768010875577797906138766391845135377424890965521440233301772052",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7005258728852995460900263537370745968630166959734206159957799221191925945602",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6345451795676342424205730938660185178325967413255712040877211691532798689536",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2780978923276769603084110452947415993768824535337654671457442495556365161036",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "219671864641846575934756268958949205252482364792826985138865722150409651877",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2443931363154274626039717967689506791351357117257173081384847784325709078475",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13124186496213605736903678544398349776579723065394336602175410821613905218508",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5432513339728268829134323309369787365379820462455443204721589629977134312631",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10745936869168790696368181125446125013764092826641393505115044228223535523023",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2700209967286437008389190340075174766403488226669328017790667859130312864557",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15772893083972477184537403920426585293594439809285129872672815610040350722871",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21294428622740779056903376466216234290427165681731300802847694130469993394218",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15894266239135468928185960163477926922877264274860345967753038330869627204155",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1096368123578790517530711897777194394731212499866120053001617840145178088046",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1394159664042366811003813388790050758063269308116252272062876498627195056527",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11261056337190313066266746243632478642455050257003187980730240798531224877809",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17305755215616267997146077497692988596800400998462752069352600363708883007839",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15371909256746742985463109622300958997197963549518997301051533693886710333747",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20448403594130444648089851873755778887290146036948090191937739293689284059473",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4729734530435653548119746580911521748567799572047317151447278252902717458440",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9055786267907928908044744667038735571363428775572377654006433176678216544138",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9245235689750537947580373772395968915903822328347419898008094165262061513168",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3259295965548895132416347844457131035605305127351914029013784648223586893840",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8133110647024433575836378618144076616087915311423771001766168251715944436436",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18008110744560769834041791617986172641037836309092881379393935691644464895108",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9013781624325778780635119850834699693214454594410089381646984478492152387681",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8639475724251693453868768913531642954729623102539857464903122082472741556796",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20830477318165650288464577487190659978049487402162708436273498600859419634",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13349403513519757309593948043861292012890478614413714204682445685718878345535",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12328718012639542828603926948594616778151940577607872267472093244388211484665",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2915193368065516044845133384670589952110028644251918175654110563684523822623",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "734569780368547903851295084790632331276116174575476972380730437666080976462",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "671279589493917786728461606950395733859229090661420264134519841071301262611",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14678633946393860532975080521069035476080119750719889071999652281987539169763",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1691723231954090840146258931861867912252544708433831341842516308673817885610",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15574291717899911745152218359999334153551671302357403351163198662554477508279",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5981433277656201872845331017220505919530200539512006725994262794217018602010",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18156370456324591238469578107588309514554581437801913401654775491244030795770",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1556309133439204006654419798348540449388501185001051750586019510457868307958",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4356046460272772399467859547886701446225520814019018000924715176417367561817",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15450880045468650144156961948500828099983553409239937576968037166948001455511",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3569335951432407776495772012753227552443207946081123669782387270240663238980",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20299619590358223273964702925591899099197268683684968495953258757381055203999",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1737269388672443415630244155940415723987255613151927271717623952056489022942",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7676370330863607260797103988986524817754264672351485136731920308227511577030",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10764843120898224557535111936383223186451299651941198232539050093196747543756",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2819356662200804458856836085264643083461835827345828419663815020125966978385",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14230399494919677144321487695512822636538939956639271484923914516686249040244",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6229792639229852919549182508857380693477833417363232050296992412866445633778",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3106676750956526417925705057501789384016262285679193764776023640126964109042",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "19031174113953815401575291273416077779134839378929564662214633569481371994627",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4938890649131231154991766222525002264167203279761035096310595945387423228795",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9092947503088322001901942345058983345234772453274860663410155583684545688529",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4443468689502285528589936084153593105296452987872236962264792108454557959607",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13722785522864435678176292501919399406320755026890489431768679408994572946910",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13256667663287458052646690425465025507007074499017697722372788741483765988169",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3342109259843261627877766497639597960616083706719254912542704334341413113811",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8377411907540655144604614191841171970491144397410270165752490408438880282950",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21175860851919058796901112169110721691550903636481812384865553578742784165824",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1758219250556332515525607381478749746944627538834804425466160661798760928660",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8100116405804673915839318005809562313337323503890310411989391068380938049891",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10950382949046383428868423373874360297216755027265677947152651089682316462002",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2960277668778712586277871117504309767461547310299729646458954502866505810933",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12436779988817213442780718350478562778741169493686625046971163883056781227217",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18433130870381757859416696830699316172155927980655832716601174117670334361663",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8929014056758944506773121953984691621375460981653721583817790162968859020827",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21021117587745109604358066010067802867362858152931661595258839458778309017921",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3687110520160985940053416129106142708996683054120258602350677914558228149704",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "80825880291398182792276850849647837369189970581427465051543823269639712237",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15602858448994554323587941766253362391857349901811304586895693153675332257479",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13135494086574956175617288396849614521078575779781791595261561845703124468256",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15393949948260444958980146663126583924466023603235882001681196779684410878420",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18384989275581989698635194175130733158283698892545299942532908080907204625644",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "485819771042979048690736635548322492095227593209398128669906407316732600888",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3969961112111760614492622183501881958866859761703927612714294408063065400072",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8752648669145926648227277846713521231276713532721674183702641053051161352313",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7585110218885204638023993650637083463989720045086789711575843350789273631911",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2494379627738416372577673662163694139249446937999082811387265339768290503797",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20616688053782525026898984172292202648073622844719283906076705056594026518452",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9900087106206622398227913281602779201149185950522515728836722160259149448172",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11017903209339322884500424701067037363510354251034908831176623007763979729891",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11242911200839364801115949018449987647748348820992122514426624004928045344694",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "19232429724858702744754565081221224741960943688294029401593672990665719107878",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "16765052252594983393669755070044308615954848363525024643880249721059862220578",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6842036836789558363749002265840843768314388887366152991347087598440783984114",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21393710061740643339940504965509850732741799591113979313939113730695101694096",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9622969983019916007969470405619112229949366797764113862835459776222718281535",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13767247240219074238794646743011288498093412255264931357766139021509967203039",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20328692478494464365122435286989408673672104431805610695614028351842993934534",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9073999256592381826494042793078479866030288210942587220949345879429845129344",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8385133441250571023649882990135092851061706452670332562366981695578823064040",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6908037916791839012443104181201551324508228729079993473762605932494330190638",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7944824570503701879156726471230631291347547538049727334541219865644837323988",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18800482911329847069658844436812670171974070641520523903011375486406401133846",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2730366093593546914821994695117890569154816790844740397371897554795276235383",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5675297339307536929988306800229752810880677519055155910685928984270724939639",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8840975546939648540488041522549892926507078571712382410740665008159904893712",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20979353866970550917873042661559159890255433653612953419331011151144149783744",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "516844421659953336774353304123555882256525184827876947252825317542649719056",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "551311298954341872590849377639279261005593012684858706728599073331951775432",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21048129191517485874758270018130757373572343861561541709103852181146637709285",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "883108184400682278340850461255904007212979661827816162352333281411119132932",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14420640332119892506393437524000256966511511660102357305862673030163266588863",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6769807849276165954616728496863793269428109021002779834929547188571900768755",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11299306373336024504558247995641644825418404376401286822173736758483745500585",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3383499335919177296989189306855753260005794820125735943026533024070779082856",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3433708777679466194488047633816494102612852206949168870493217054333441112985",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13364335699281038824576139080495276061523646519119171104214550514343584904357",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "19088517692777810072139780055414076811493668977474813912864370395663606472109",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17046893265171064448293585872818107620988569612784541924208567811178685573298",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3339406933518442876411910401896457020433273656520834348101852668427397002466",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6394754036751016627974453048774687667103663469778455952578525678514140357908",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13348080011937103566625637585590574831645542599062267708945074519374215924576",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2035451312942883968544771537469165070918629861375811750777728864744610711929",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7534846726693802303568319129617958732413064154452139317544115737563440922906",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5142893372197042264809108797404775402895973963341426202916561252529309911953",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7387703761213293203195518374872886870044236674278580805224056813041998830918",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9834981306855341246423988959170352646074821767371321543902587618825629388790",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10591940164582290683765523873302053954617746134288371151158550854319230671848",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "19645940765685168416476108842047364297815786496263306942428428501384703436530",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "806317401532332279371557871696268272788644426105491726521005970610425656401",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14873156151354922251283278949136754794279449340904101629102561195129848597881",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14877529356535812861712404300630166048169645526789734524489710998713041156616",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21101727915049995883360583090020188667871655700326983236468917802238514631527",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8784561081435496519936150848470355611125213198581563342192869536231698468724",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12951011119123862602637073643625306517125538175126787345374445023875682668190",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4754486070458897643044014762078146540057558083321156154490263991438824591559",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6698229600376653940889127765081219516223590790118662195996060465168245635029",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3488212148323687832952214845303080200128370770801913448081307315149532795755",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13395974002200754692425063613054297713599822621888055825281485401829047673168",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21306313216752316778610596575521334059455780410245249300161336400126377013198",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14440430794889894255165366081371645366323676828730327401596635433732808761635",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11301736477249846070880364749238210747019850007649734004911360387721732439176",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18529371950411247463536323927264771481897887775743653755596309214956011300885",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2024094455599253391879172765188241728909648958146830531168621392830348748452",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12380443335956575796199242302050308002170284713778975658193413541837749582704",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17800128209140157388583882622714179816536883599865901438503119252725091065454",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21045861938698937974912479796474383908520405721888783097215705657386912086696",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4141409637360999331951189783363878171311106492172769273638619574221156829121",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14259414300388792410641104009760954363156850399537170069218165074426770063617",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4451799750330945793479450341858976120375530940735690476632525521874862862324",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18172943363350781888342804719974357493732050248863214305201835660468795448831",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14803601458117323257887833141099311008736410980719735518416107862729259860503",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8012097819445489095043609535945175643371775681362129577114806789033825080174",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20987299682170427723890380587526212844337242486458048148468388739903558239166",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "10548394851179037704178101661877192514367125574136880556232929084397088507285",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20436799052987452454072495255981676264927711874374541657901611880206848218041",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11989711640394693472854276906656379594783073287861131885588974887589308529140",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18091352772795342278278111004131463236456400626592100937570367790871324385847",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12711678752325475197741198013733874816358621859214685652221956581940736498324",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1190440422304761108055570691102969032887211603334032397741971602684610500183",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20742281673328504122132555473443044322771333000072182383854251396175500629988",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6330789123996977458876730494567876598951832573056269268585355576434452265824",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7613427805763613770396578102318646348515686256763144477876781927753355511242",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2767787737080836074588827866493428969025899581972950836068099283611716162872",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12368938928679702085904015193412499809238916971742093835750222401100611164036",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2120299666226961199589805206721729429805450574305859164922602701608405684727",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "16101730347660865451514214922930122989814420468390642556358093789599914392935",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14613859797855964370156853496634409122022020442980743716687965083719225519778",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3779283189030991331381776355121793593816122884996482647339823869532343988764",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "16538148594031353209577287616352326794499928553504745660554665295855556894824",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3123079822626887350655514696649580980677141915307255141970749507463896361323",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "12982425935199817815259066755446031161131158570221278702242861239646270552470",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5102498747304120681063234869297561678666553390318425372362768137182642230556",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5650907760235911671502574958247698947488602341810330231889326036197969521231",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15311713639934636809857700294816883015313069642974788089784484331866842863071",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4378917750778986566195783994933317136780665487997343184053349232575020190805",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17269370569234016318347144117809553750186193189061649546246584002692850765629",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15965151781956286974774343502657082669197845298829367751669865649959140668605",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21450812444968239732217119395020350433942366034590850012483985750698873548994",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15683936267873086453313398000666330885268595221356044868315623959998545803993",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3671832753185336498356295312340707707414043518732009721061564751475499397884",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8481986539959965597443698434877359782057734265717731981500359220829881743669",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7660359655796884328413537474185961598411595576826789377114759090571468288601",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "15099124105714544055181852556690181850324058320144202151709072305108445970672",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "20318193804808062899310835542933059696106644785975739849404243508909313676170",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "19507005947491991053222274938143459936049667535869659344107661714058651936303",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9680025363676779851027254588433018356491149034845693284454451321234537209837",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7977470924284966780400839042253052128867651372085267651005651852743199555955",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6289851497425782381089985916585292730162942529496823947960740692893599485508",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "1278198251448605653669861163912985025434795035476225580040678106599898395055",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "778822024062014472867802453882888474232798997852884487172408961114550237272",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "17813998309135288259967425155412879887627227853886754905994951577284709256891",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "13046754442426756722325203449473048800017855579216820439904651005250574252301",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2675026038592592996108363640079209157158679725371291640028590665609721944662",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "4508630743012318612584732934628562592521561330245083297020204983532991482453",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "11205586019601053374384489950424904802845225981790097591516963184783396704786",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3269337097979539661372044451055530562428122764943331896964292158786499210701",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21019215961028087428383457025829718359262809032898137235613214997150896209535",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3466829339166757648673145858981890214467602134411898125584568038757537007697",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "5157412242877806836300066366873354964107079264741076245467526756146318011096",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "21581392381591215300367149151779503009022070613614304076664343782920390616547",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18549000796552159819327648418939689514195739516390499357595136551758253444650",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9515161205290672029912318778766314272223114844295330905826919799686753566536",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6709763924604181304099526756361626798321199970667226939575017525120090147429",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3564812180471312318342772028868158337379185681492234710321340015348576731268",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2715256219839290031990931607545071222786464220056110728638073108255144059506",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "2526648118676632885942026268297123310722360774374297527748460434510013028101",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14946395762997152888563288005029334540378039755814859784393666974164235199684",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "8924616408420875343266627737208318913120073601143028545020037129947462534137",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "14553445721437460754651496265942888390087731770131124952756252097400616930608",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6484523689837038546406369281981798795409487950329098695251686883211239498930",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "7511745149465107256748700652201246547602992235352608707588321460060273774987",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "6279378546762757460220383767956301075209286500691039336178850629635359180183",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "3249524281869446882651222652032498789242625585725252350645660151130325444989",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "18732019378264290557468133440468564866454307626475683536618613112504878618481",
        )
        .unwrap(),
        Fr::from_str_vartime(
          "9131299761947733513298312097611845208338517739621853568979632113419485819303",
        )
        .unwrap(),
      ],
    }
  }
}

#[derive(Clone)]
struct PoseidonCircuit {
  _state: std::marker::PhantomData<Vec<Fr>>,
}

impl PoseidonCircuit {
  fn new() -> Self {
    Self {
      _state: std::marker::PhantomData,
    }
  }
}

pub fn ark<CS: ConstraintSystem<Fr>>(
  t: usize,
  r: usize,
  state: &[AllocatedNum<Fr>],
  poseidon_c: &[Fr],
  cs: &mut CS,
) -> Result<Vec<AllocatedNum<Fr>>, SynthesisError> {
  let mut ark_output = Vec::new();

  for i in 0..t {
    let constant = AllocatedNum::alloc(cs.namespace(|| format!("ark_constant_{}", i)), || {
      Ok(poseidon_c[i + r])
    })?;

    let sum = state[i].add(cs.namespace(|| format!("ark_add_{}", i)), &constant)?;
    ark_output.push(sum);
  }

  Ok(ark_output)
}

pub fn sigma<CS: ConstraintSystem<Fr>>(
  value: &AllocatedNum<Fr>,
  cs: &mut CS,
) -> Result<AllocatedNum<Fr>, SynthesisError> {
  let x = value;

  let x2 = x.mul(cs.namespace(|| "x^2"), x).unwrap();
  let x4 = x2.mul(cs.namespace(|| "x^4"), &x2).unwrap();
  let x5 = x4.mul(cs.namespace(|| "x^5"), x).unwrap();

  Ok(x5)
}

pub fn iterated_add<CS: ConstraintSystem<Fr>>(
  cs: &mut CS,
  terms: &[AllocatedNum<Fr>],
) -> Result<AllocatedNum<Fr>, SynthesisError> {
  let mut sum = terms[0].clone();

  for term in &terms[1..] {
    sum = sum.add(cs.namespace(|| "iterated_add"), term)?;
  }

  Ok(sum)
}

pub fn mix<CS: ConstraintSystem<Fr>>(
  t: usize,
  poseidon_m: &[Vec<Fr>],
  cs: &mut CS,
  state: &[AllocatedNum<Fr>],
) -> Result<Vec<AllocatedNum<Fr>>, SynthesisError> {
  let mut new_state = Vec::new();

  for i in 0..t {
    let mut terms = Vec::new();
    for j in 0..t {
      let constant =
        AllocatedNum::alloc(cs.namespace(|| format!("mix_constant_{}_{}", i, j)), || {
          Ok(poseidon_m[j][i])
        })?;
      let term = state[j].mul(cs.namespace(|| format!("mix_mul_{}_{}", i, j)), &constant)?;
      terms.push(term);
    }
    let mixed = iterated_add(cs, &terms)?;
    new_state.push(mixed);
  }

  Ok(new_state)
}

pub fn mix_last<CS: ConstraintSystem<Fr>>(
  t: usize,
  poseidon_m: &[Vec<Fr>],
  cs: &mut CS,
  state: &[AllocatedNum<Fr>],
  s: usize,
) -> Result<Vec<AllocatedNum<Fr>>, SynthesisError> {
  let mut terms = Vec::new();
  for j in 0..t {
    let constant = AllocatedNum::alloc(cs.namespace(|| format!("mix_constant_{}", j)), || {
      Ok(poseidon_m[j][s])
    })?;
    let term = state[j].mul(cs.namespace(|| format!("mix_mul_{}", j)), &constant)?;
    terms.push(term);
  }
  let mixed = iterated_add(cs, &terms)?;

  Ok(vec![mixed])
}

pub fn mix_s<CS: ConstraintSystem<Fr>>(
  t: usize,
  r: usize,
  poseidon_s: &[Fr],
  cs: &mut CS,
  state: &[AllocatedNum<Fr>],
) -> Result<Vec<AllocatedNum<Fr>>, SynthesisError> {
  let mut terms = Vec::new();
  let mut new_state = Vec::new();

  for i in 0..t {
    let constant = AllocatedNum::alloc(cs.namespace(|| format!("mix_constant_{}", i)), || {
      Ok(poseidon_s[(t * 2 - 1) * r + i])
    })?;
    let term = state[i].mul(cs.namespace(|| format!("mix_mul_{}", i)), &constant)?;
    terms.push(term);
  }
  let mixed = iterated_add(cs, &terms)?;
  new_state.push(mixed);

  let mut second_loop = Vec::new();
  for i in 1..t {
    let constant = AllocatedNum::alloc(cs.namespace(|| format!("mix_constant_{}", i)), || {
      Ok(poseidon_s[(t * 2 - 1) * r + t + i - 1])
    })?;

    let term = state[0].mul(cs.namespace(|| format!("mix_mul_{}", i)), &constant)?;

    let value = state[i].add(cs.namespace(|| format!("mix_add_{}", i)), &term)?;

    second_loop.push(value);
  }
  new_state.extend(second_loop);

  Ok(new_state)
}

lazy_static! {
  pub static ref POSEIDON_CONSTANTS: PoseidonConstants = PoseidonConstants::new();
}

impl StepCircuit<Fr> for PoseidonCircuit {
  fn arity(&self) -> usize {
    2
  }

  fn synthesize<CS: ConstraintSystem<Fr>>(
    &self,
    cs: &mut CS,
    z: &[AllocatedNum<Fr>],
  ) -> Result<Vec<AllocatedNum<Fr>>, SynthesisError> {
    let t = 3;
    let n_rounds_f = 8;
    let n_rounds_p = 57;

    let constants = &*POSEIDON_CONSTANTS;

    // Create initial state [0, x, y] where x,y come from input z
    let zero = AllocatedNum::alloc(cs.namespace(|| "zero_initial"), || Ok(Fr::zero()))?;
    let mut state = vec![zero, z[0].clone(), z[1].clone()];

    // Initial Ark
    state = ark(t, 0, &state, &constants.c, cs)?;

    // First half of full rounds
    for r in 0..(n_rounds_f / 2 - 1) {
      for value in &mut state {
        *value = sigma(value, cs)?;
      }
      state = ark(t, (r + 1) * t, &state, &constants.c, cs)?;
      state = mix(t, &constants.m, cs, &state)?;
    }

    // Middle round
    state = state
      .iter()
      .map(|val| sigma(val, cs))
      .collect::<Result<Vec<_>, _>>()?;
    state = ark(t, (n_rounds_f / 2) * t, &state, &constants.c, cs)?;
    state = mix(t, &constants.p, cs, &state)?;

    // Partial rounds
    for r in 0..n_rounds_p {
      let sigma_result = sigma(&state[0], cs)?;
      let constant = AllocatedNum::alloc(cs.namespace(|| format!("partial_const_{}", r)), || {
        Ok(constants.c[(n_rounds_f / 2 + 1) * t + r])
      })?;
      let first = sigma_result.add(cs.namespace(|| format!("partial_add_{}", r)), &constant)?;
      state = mix_s(
        t,
        r,
        &constants.s,
        cs,
        &[vec![first], state[1..].to_vec()].concat(),
      )?;
    }

    // Second half of full rounds
    for r in 0..(n_rounds_f / 2 - 1) {
      for value in &mut state {
        *value = sigma(value, cs)?;
      }
      state = ark(
        t,
        (n_rounds_f / 2 + 1) * t + n_rounds_p + r * t,
        &state,
        &constants.c,
        cs,
      )?;
      state = mix(t, &constants.m, cs, &state)?;
    }

    // Final Round
    state = state
      .iter()
      .map(|val| sigma(val, cs))
      .collect::<Result<Vec<_>, _>>()?;

    // Final MixLast
    let final_result = mix_last(t, &constants.m, cs, &state, 0)?;

    println!("Poseidon output: {:?}", final_result[0]);

    Ok(final_result)
  }
}

pub fn hasher<CS: ConstraintSystem<Fr>>(
  previous_hash: &AllocatedNum<Fr>,
  new_input: &AllocatedNum<Fr>,
  cs: &mut CS,
) -> Result<AllocatedNum<Fr>, SynthesisError> {
  let t = 3;
  let n_rounds_f = 8;
  let n_rounds_p = 57;

  let constants = &*POSEIDON_CONSTANTS;

  // Create initial state [0, previous_hash, new_input]
  let zero = AllocatedNum::alloc(cs.namespace(|| "zero_initial"), || Ok(Fr::zero()))?;
  let mut state = vec![zero, previous_hash.clone(), new_input.clone()];
  println!("HASHER STATE: {:?}", state);

  // Initial Ark
  state = ark(t, 0, &state, &constants.c, cs)?;

  // First half of full rounds
  for r in 0..(n_rounds_f / 2 - 1) {
    for value in &mut state {
      *value = sigma(value, cs)?;
    }
    state = ark(t, (r + 1) * t, &state, &constants.c, cs)?;
    state = mix(t, &constants.m, cs, &state)?;
  }

  // Middle round
  state = state
    .iter()
    .map(|val| sigma(val, cs))
    .collect::<Result<Vec<_>, _>>()?;
  state = ark(t, (n_rounds_f / 2) * t, &state, &constants.c, cs)?;
  state = mix(t, &constants.p, cs, &state)?;

  // Partial rounds
  for r in 0..n_rounds_p {
    let sigma_result = sigma(&state[0], cs)?;
    let constant = AllocatedNum::alloc(cs.namespace(|| format!("partial_const_{}", r)), || {
      Ok(constants.c[(n_rounds_f / 2 + 1) * t + r])
    })?;
    let first = sigma_result.add(cs.namespace(|| format!("partial_add_{}", r)), &constant)?;
    state = mix_s(
      t,
      r,
      &constants.s,
      cs,
      &[vec![first], state[1..].to_vec()].concat(),
    )?;
  }

  // Second half of full rounds
  for r in 0..(n_rounds_f / 2 - 1) {
    for value in &mut state {
      *value = sigma(value, cs)?;
    }
    state = ark(
      t,
      (n_rounds_f / 2 + 1) * t + n_rounds_p + r * t,
      &state,
      &constants.c,
      cs,
    )?;
    state = mix(t, &constants.m, cs, &state)?;
  }

  // Final Round
  state = state
    .iter()
    .map(|val| sigma(val, cs))
    .collect::<Result<Vec<_>, _>>()?;

  // Final MixLast - returns only the hash (first element)
  let final_result = mix_last(t, &constants.m, cs, &state, 0)?;

  // Return just the hash (single element)
  Ok(final_result[0].clone())
}

fn main() {
  let circuit = PoseidonCircuit::new();
  let z0 = vec![Fr::from(1u64), Fr::from(2u64)];

  let pp =
    PublicParams::<E1, E2, PoseidonCircuit>::setup(&circuit, &*S1::ck_floor(), &*S2::ck_floor())
      .unwrap();

  let mut recursive_snark = RecursiveSNARK::new(&pp, &circuit, &z0).unwrap();
  recursive_snark.prove_step(&pp, &circuit).unwrap();
  let result = recursive_snark.verify(&pp, 1, &z0).unwrap();
  println!("Nova Poseidon([0,1,2]): {:?}", result);
}
